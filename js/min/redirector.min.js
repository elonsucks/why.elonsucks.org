(async()=>{let urls={all:function extractURLs(obj){let urls=[];return Array.isArray(obj)?obj.forEach(entry=>{"string"==typeof entry?urls.push(entry):urls.push(...extractURLs(entry))}):obj.url?urls.push(obj.url):Object.values(obj).forEach(val=>urls.push(...extractURLs(val))),urls}(await(await fetch("assets/data/urls.json")).json()),visited:JSON.parse(localStorage.weso_visitedURLs||"[]")},randURL=(urls.unvisited=urls.all.filter(url=>!urls.visited.includes(url)),urls.unvisited.length||(urls.unvisited.push(...urls.all),urls.visited.length=0,localStorage.weso_visitedURLs="[]"),urls.unvisited[Math.floor(Math.random()*urls.unvisited.length)]);if(location.search.startsWith("?debug")){let debugOutput=`<pre>Redirect URL (#${urls.unvisited.indexOf(randURL)+1} of ${urls.unvisited.length} unvisited):
`+`<strong><a href="${randURL}">${randURL}</a></strong></pre>`;location.search.endsWith("=all")&&["unvisited","visited"].forEach(urlsType=>{var numberedURLs=JSON.stringify(urls[urlsType],null,2).replace(/"http/g,(match,offset,string)=>(string.slice(0,offset).match(/"http/g)||[]).length+1+'. "'+match.slice(1));debugOutput+=`<pre>urls.${urlsType} = ${numberedURLs.replace(new RegExp(`\\d+\\. "${randURL}"`),'<strong style="color: #48b720">$&</strong>')}</pre>`}),document.write(debugOutput)}else localStorage.weso_visitedURLs=JSON.stringify([...urls.visited,randURL]),document.location=randURL})();